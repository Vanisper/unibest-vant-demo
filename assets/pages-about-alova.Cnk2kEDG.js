var ze=Object.defineProperty,Qe=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var pe=(t,e,s)=>e in t?ze(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,S=(t,e)=>{for(var s in e||(e={}))Ze.call(e,s)&&pe(t,s,e[s]);if(fe)for(var s of fe(e))je.call(e,s)&&pe(t,s,e[s]);return t},O=(t,e)=>Qe(t,Xe(e));var F=(t,e,s)=>new Promise((o,n)=>{var i=f=>{try{l(s.next(f))}catch(p){n(p)}},r=f=>{try{l(s.throw(f))}catch(p){n(p)}},l=f=>f.done?o(f.value):Promise.resolve(f.value).then(i,r);l((s=s.apply(t,e)).next())});import{E as ke,r as Ie,G as Lt,H as he,I as ts,J as me,K as es,L as ss,M as os,N as ns,A as as,O as rs,Q as cs,R as ge,d as is,c as ve,w as k,a as ls,f as Ht,h as ut,i as ds,D as us,u as Rt,k as gt,s as fs,F as ps,t as Se,C as hs}from"./index-Cd1M-BUL.js";const Ot="undefined",q=Promise,ms=t=>q.resolve(t),gs=t=>q.reject(t),wt=Object,oe=RegExp,m=void 0,Te=null,U=!0,M=!1,I=(t,e,s)=>t.then(e,s),vs=(t,e)=>t.catch(e),Fe=(t,e)=>t.finally(e),Ae=(t,e,s)=>JSON.stringify(t,e,s),Ss=t=>JSON.parse(t),Nt=(t,e=0)=>setTimeout(t,e),Cs=t=>clearTimeout(t),ct=t=>wt.keys(t),ws=t=>wt.values(t),H=(t,e)=>t.forEach(e),V=(t,...e)=>t.push(...e),Z=(t,e)=>t.map(e),St=(t,e)=>t.filter(e),ys=(t,e,s=0,...o)=>t.splice(e,s,...o),B=t=>t.length,ne=t=>Array.isArray(t),ft=(t,e)=>delete t[e],ae=t=>typeof t,Wt=(t,e)=>t.includes(e),Rs=typeof window===Ot&&(typeof process!==Ot?!process.browser:typeof Deno!==Ot),Gt="memory",Et="restore",D=()=>{},Ft=t=>t,T=t=>ae(t)==="function",re=t=>ae(t)==="number"&&!Number.isNaN(t),ce=t=>ae(t)==="string",Pe=t=>wt.prototype.toString.call(t),tt=t=>Pe(t)==="[object Object]",z=(t,e)=>t instanceof e,Ct=t=>t?t.getTime():Date.now(),mt=t=>t.context,pt=t=>t.config,Ne=t=>t.options,xs=t=>Ne(mt(t)),_s=t=>{const{params:e,headers:s}=pt(t);return Ae([t.type,t.url,e,t.data,s])},yt=t=>t.key,De=(t,e,s=[])=>{const o=T(t)?t(...s):t;return e(!!o.key,"hook handler must be a method instance or a function that returns method instance"),o},Es=t=>{const e=Pe(t);return/^\[object (Blob|FormData|ReadableStream|URLSearchParams)\]$/i.test(e)||z(t,ArrayBuffer)},ie=(t,...e)=>wt.assign(t,...e),Ms=(t,...e)=>{const s={};for(const o in t)e.includes(o)||(s[o]=t[o]);return s};function bs(){let t,e;return{promise:new Promise((o,n)=>{t=o,e=n}),resolve:t,reject:e}}const qe=t=>{const{cacheFor:e}=pt(t),s=f=>re(f)?Ct()+f:Ct(f||m);let o=Gt,n=()=>0,i=M,r=m;const l=T(e);if(!l){let f=e;if(tt(e)){const{mode:p=Gt,expire:a,tag:c}=e||{};o=p,i=p===Et,r=c?c.toString():m,f=a}n=p=>s(T(f)?f({method:t,mode:p}):f)}return{f:e,c:l,e:n,m:o,s:i,t:r}},_=(t,...e)=>new t(...e),$e=(t,e=[])=>T(t)?t(...e):t,Us=(t,e)=>T(t)?t:[M,Te].includes(t)?D:e,Ts=(t=0)=>{let e=m;return s=>{e&&clearTimeout(e),e=Nt(s,t)}},Fs="$a.",Dt=(t,e)=>Fs+t+e,As=(t,e,s)=>{const o=/^https?:\/\//i.test(e);o||(t=t.endsWith("/")?t.slice(0,-1):t,e!==""&&(e=e.startsWith("/")?e:`/${e}`));const n=o?e:t+e,i=ce(s)?s:Z(St(ct(s),r=>s[r]!==m),r=>`${r}=${s[r]}`).join("&");return i?+n.includes("?")?`${n}&${i}`:`${n}?${i}`:n},Jt=t=>{if(ne(t))return Z(t,Jt);if(tt(t)&&t.constructor===wt){const e={};return H(ct(t),s=>{e[s]=Jt(t[s])}),e}return t};class Ps extends Error{constructor(e,s,o){super(s+(o?`

For detailed: https://alova.js.org/error#${o}`:"")),this.name=`[alova${e?`/${e}`:""}]`}}const qt=(t="")=>(e,s,o)=>{if(!e)throw _(Ps,t,s,o)},Ns=JSON.parse,Ds=()=>Ns.bridgeData||{},le=()=>{const t={};return{eventMap:t,on(e,s){const o=t[e]=t[e]||[];return V(o,s),()=>{t[e]=St(o,n=>n!==s)}},off(e,s){const o=t[e];if(o)if(s){const n=o.indexOf(s);n>-1&&o.splice(n,1)}else delete t[e]},emit(e,s){const o=t[e]||[];return Z(o,n=>n(s))}}};class xt{constructor(e,s,o,n){this.s=e,this.k=s,this.$dhy=o,this.$exp=n}get v(){return this.$dhy(this.s)}get e(){return this.$exp(this.s)}}class Ce extends xt{constructor(e,s,o,n,i){super(e,s,o,n),this.$upd=i}set v(e){this.$upd(this.s,e)}get v(){return this.$dhy(this.s)}}let de={autoHitCache:"global",ssr:Rs};const Mt="color: black; font-size: 12px; font-weight: bolder";var qs=(t,e,s,o)=>{const n=console,i=(...d)=>{},{url:r}=e,l=s===Et,f="\x1B[42m%s\x1B[49m",p="\x1B[32m%s\x1B[39m",a=` [HitCache]${r} `,c=()=>Array(B(a)+1).join("^");de.ssr?(i(f,a),i(p," Cache ",t),i(p," Mode  ",s),l&&i(p," Tag   ",o),i(p,c())):(n.groupCollapsed?n.groupCollapsed("%cHitCache","padding: 2px 6px; background: #c4fcd3; color: #53b56d;",r):i(f,a),i("%c[Cache]",Mt,t),i("%c[Mode]",Mt,s),l&&i("%c[Tag]",Mt,o),i("%c[Method]",Mt,e),n.groupEnd?n.groupEnd():i(p,c()))};const Yt=t=>`hss.${t}`,Ke="hsr.",zt=t=>Ke+t,At="$$hsrs",Le="__$<>$__",Qt=(t,e)=>{t[e]=0},Bt=(t,e,s,o,n,i,r)=>F(void 0,null,function*(){if(o>Ct()&&s){const l=Dt(t,e);if(yield n.set(l,St([s,o===1/0?m:o,r],Boolean)),i){const f={},p=[];H(i,d=>{const u=z(d,oe),w=u?d.source+(d.flags?Le+d.flags:""):d;w&&(u&&!f[w]&&V(p,w),Qt(f,u?zt(w):Yt(w)))});const a=Z(ct(f),d=>F(void 0,null,function*(){const u=(yield n.get(d))||{};Qt(u,l),yield n.set(d,u)})),c=()=>F(void 0,null,function*(){if(B(p)){const d=(yield n.get(At))||[];V(d,...p),yield n.set(At,d)}});yield q.all([...a,c()])}}}),$s=(t,e,s)=>F(void 0,null,function*(){const o=Dt(t,e);yield s.remove(o)}),He=(t,e,s,o)=>F(void 0,null,function*(){const n=yield s.get(Dt(t,e));if(n){const[i,r,l]=n;if(l===o&&(!r||r>Ct()))return n;yield $s(t,e,s)}}),Tt=(t,e,s,o)=>F(void 0,null,function*(){const n=yield He(t,e,s,o);return n?n[0]:m}),Ks=(t,e,s)=>F(void 0,null,function*(){const o=`${e}`,n={},i=Yt(t);n[i]=yield s.get(i);let r;if(e){const a=Yt(o);n[a]=yield s.get(a),r=yield s.get(At);const c=[];r&&B(r)&&(H(r,d=>{const[u,w]=d.split(Le);_(oe,u,w).test(o)&&V(c,d)}),yield q.all(Z(c,d=>F(void 0,null,function*(){const u=zt(d);n[u]=yield s.get(u)}))))}const l=a=>F(void 0,null,function*(){try{yield s.remove(a);for(const c in n){const d=n[c];d&&ft(d,a)}}catch(c){}}),f={};yield q.all(Z(ct(n),a=>F(void 0,null,function*(){const c=n[a];if(c){const d=[];for(const u in c)f[u]||(Qt(f,u),V(d,l(u)));yield q.all(d)}})));const p=B(r||[]);yield q.all(Z(ct(n),a=>F(void 0,null,function*(){const c=n[a];c&&(B(ct(c))?yield s.set(a,c):(yield s.remove(a),a.includes(Ke)&&r&&(r=St(r,d=>zt(d)!==a))))}))),p!==B(r||[])&&(yield s.set(At,r))});var Ls=t=>{const{data:e,config:s}=t,o=S({},s),{headers:n={},params:i={}}=o,r=mt(t);o.headers=S({},n),o.params=ce(i)?i:S({},i);const l=_(W,t.type,r,t.url,o,e);return ie(l,O(S({},t),{config:o}))};const Hs=(s,...o)=>F(void 0,[s,...o],function*(t,{policy:e="all"}={}){if(t&&t.key){const{id:n,l1Cache:i,l2Cache:r}=mt(t),l=yt(t),{f,c:p,s:a,e:c,t:d}=qe(t);if(p)return f();let u=e!=="l2"?yield Tt(n,l,i):m;return e==="l2"?u=yield Tt(n,l,r,d):e==="all"&&!u&&a&&c(Et)>Ct()&&(u=yield Tt(n,l,r,d)),u}}),Os=t=>F(void 0,null,function*(){const{autoHitCache:e}=de,{l1Cache:s,l2Cache:o}=mt(t),n=yt(t),{name:i}=pt(t),r={global:[...Zt,...jt],self:[s,o],close:[]}[e];r&&B(r)&&(yield q.all(Z(r,l=>Ks(n,i,l))))}),we={};function Ws(t,e){let s=U,o;const n=_(q,r=>{o=r});return{abort:()=>{I(n,r=>r&&r.abort())},onDownload:r=>{I(n,l=>l&&l.onDownload&&l.onDownload(r))},onUpload:r=>{I(n,l=>l&&l.onUpload&&l.onUpload(r))},response:()=>F(this,null,function*(){const{beforeRequest:r=D,responded:l,requestAdapter:f,cacheLogger:p}=xs(t),a=yt(t),{s:c,t:d,m:u,e:w}=qe(t),{id:C,l1Cache:y,l2Cache:$,snapshots:b}=mt(t),{cacheFor:g}=pt(t),{hitSource:v}=t;let N=yield T(g)?g():e?m:Tt(C,a,y);if(u===Et&&!N&&!e){const A=yield He(C,a,$,d);if(A){const[J,at]=A;yield Bt(C,a,J,at,y,v),N=J}}const E=Ls(t);yield r(E);const{baseURL:et,url:st,type:Q,data:K}=E,{params:L={},headers:lt={},transform:G=Ft,shareRequest:dt}=pt(E),ot=we[C]=we[C]||{},nt=E.data,X=Es(nt);let h=X?m:ot[a],R=Ft,x=m,P=D;if(T(l))R=l;else if(tt(l)){const{onSuccess:A,onError:J,onComplete:at}=l;R=T(A)?A:R,x=T(J)?J:x,P=T(at)?at:P}if(N!==m)return o(),E.fromCache=U,Us(p,qs)(N,E,u,d),P(E),N;if(s=M,!dt||!h){const A=f({url:As(et,st,L),type:Q,data:K,headers:lt},E);h=ot[a]=A}o(h);const j=(Ve,Ge,...Wo)=>F(this,[Ve,Ge,...Wo],function*(A,J,at=U){const Je=yield A,Kt=yield G(Je,J||{});b.save(t);try{yield Os(E)}catch(Ye){}if((!nt||!X)&&at)try{yield q.all([Bt(C,a,Kt,w(Gt),y,v),c&&Bt(C,a,Kt,w(Et),$,v,d)])}catch(Ye){}return Jt(Kt)});return Fe(I(q.all([h.response(),h.headers()]),([A,J])=>(ft(ot,a),j(R(A,E),J)),A=>(ft(ot,a),T(x)?j(x(A,E),m,M):gs(A))),()=>{P(E)})}),fromCache:()=>s}}const ye=(t,e)=>()=>{const s=e.indexOf(t);s>=0&&e.splice(s,1)};class W{constructor(e,s,o,n,i){this.dhs=[],this.uhs=[],this.fromCache=m;const r=()=>{r.a()};r.a=D,e=e.toUpperCase();const l=this,f=Ne(s);l.abort=r,l.baseURL=f.baseURL||"",l.url=o,l.type=e,l.context=s;const p={},a="cacheFor",c=tt(f[a])?f[a][e]:m,d=n&&n.hitSource;H(["timeout","shareRequest"],u=>{f[u]!==m&&(p[u]=f[u])}),c!==m&&(p[a]=c),d&&(l.hitSource=Z(ne(d)?d:[d],u=>z(u,W)?yt(u):u),ft(n,"hitSource")),l.config=S(O(S({},p),{headers:{},params:{}}),n||{}),l.data=i,l.meta=n?n.meta:l.meta,l.key=l.generateKey()}onDownload(e){return V(this.dhs,e),ye(e,this.dhs)}onUpload(e){return V(this.uhs,e),ye(e,this.uhs)}send(e=M){const s=this,{response:o,onDownload:n,onUpload:i,abort:r,fromCache:l}=Ws(s,e);return B(s.dhs)>0&&n((f,p)=>H(s.dhs,a=>a({loaded:f,total:p}))),B(s.uhs)>0&&i((f,p)=>H(s.uhs,a=>a({loaded:f,total:p}))),s.abort.a=r,s.fromCache=m,s.promise=I(o(),f=>(s.fromCache=l(),f)),s.promise}setName(e){pt(this).name=e}generateKey(){return _s(this)}then(e,s){return I(this.send(),e,s)}catch(e){return vs(this.send(),e)}finally(e){return Fe(this.send(),e)}}const $t=qt(),rt="success",Bs=()=>{let t={};const e=le();return{set(o,n){t[o]=n,e.emit(rt,{type:"set",key:o,value:n,container:t})},get:o=>{const n=t[o];return e.emit(rt,{type:"get",key:o,value:n,container:t}),n},remove(o){ft(t,o),e.emit(rt,{type:"remove",key:o,container:t})},clear:()=>{t={},e.emit(rt,{type:"clear",key:"",container:t})},emitter:e}},Vs=()=>{const t=le(),e=localStorage;return{set:(o,n)=>{e.setItem(o,Ae(n)),t.emit(rt,{type:"set",key:o,value:n,container:e})},get:o=>{const n=e.getItem(o),i=n&&Ss(n);return t.emit(rt,{type:"get",key:o,value:i,container:e}),i},remove:o=>{e.removeItem(o),t.emit(rt,{type:"remove",key:o,container:e})},clear:()=>{e.clear(),t.emit(rt,{type:"clear",key:"",container:e})},emitter:t}},Gs=()=>{const t=()=>{$t(M,"l2Cache is not defined.")};return{set:()=>{t()},get:()=>(t(),m),remove:()=>{t()},clear:()=>{}}},Re=Set;class Js{constructor(e){this.records={},this.occupy=0,$t(e>=0,"expected snapshots limit to be >= 0"),this.capacity=e}save(e){const{name:s}=pt(e),{records:o,occupy:n,capacity:i}=this;s&&n<i&&((o[s]=o[s]||_(Re)).add(e),this.occupy+=1)}match(e,s=!0){let o,n,i,r=e;tt(e)&&(r=e.name,i=e.filter),z(r,oe)?n=r:ce(r)&&(o=r);const{records:l}=this;let f=_(Re);o?f=l[o]||f:n&&H(St(ct(l),a=>n.test(a)),a=>{l[a].forEach(c=>f.add(c))});const p=T(i)?St([...f],i):[...f];return s?p:p[0]}}const Xt="GET",Ys="HEAD",zs="POST",Qs="PUT",Xs="PATCH",Zs="DELETE",js="OPTIONS",xe={cacheFor:{[Xt]:3e5},shareRequest:U,snapshots:1e3};let ks=0;class Is{constructor(e){var s,o;const n=this;n.id=(e.id||(ks+=1)).toString(),n.l1Cache=e.l1Cache||Bs(),n.l2Cache=e.l2Cache||(typeof localStorage!="undefined"?Vs():Gs()),n.options=S(S({},xe),e),n.snapshots=_(Js,(o=(s=e.snapshots)!==null&&s!==void 0?s:xe.snapshots)!==null&&o!==void 0?o:0)}Request(e){return _(W,e.method||Xt,this,e.url,e,e.data)}Get(e,s){return _(W,Xt,this,e,s)}Post(e,s,o){return _(W,zs,this,e,o,s)}Delete(e,s,o){return _(W,Zs,this,e,o,s)}Put(e,s,o){return _(W,Qs,this,e,o,s)}Head(e,s){return _(W,Ys,this,e,s)}Patch(e,s,o){return _(W,Xs,this,e,o,s)}Options(e,s){return _(W,js,this,e,s)}}let _t=m;const Zt=[],jt=[],to=t=>{const e=_(Is,t),s=e.options.statesHook;_t&&s&&$t(_t.name===s.name,"expected to use the same `statesHook`"),_t=s;const{l1Cache:o,l2Cache:n}=e;return!Zt.includes(o)&&V(Zt,o),!jt.includes(n)&&V(jt,n),e},eo=()=>($t(_t,"`statesHook` is not set in alova instance"),_t),Vt={authRole:null},bt={authRole:"login"},so={authRole:"logout"},Ut={authRole:"refreshToken"},Y=({meta:t},e)=>{if(tt(t)){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const o=e[s];if(z(o,RegExp)?o.test(t[s]):t[s]===o)return U}}return M},Oe=(t,e)=>_(q,s=>{V(e,{method:t,resolve:s})}),_e=(t,e,s,o)=>{if(Y(t,(e==null?void 0:e.metaMatches)||s))return(T(e)?e:tt(e)&&T(e.handler)?e.handler:D)(o,t)},Ee=(t,e,s,o,n,i)=>F(void 0,null,function*(){const r=B(o)>=2;let l=n==null?void 0:n.isExpired(...o);if(z(l,q)&&(l=yield l),l)try{let f=U;if(r&&i&&(f=M,yield Oe(t,e)),f&&(s(U),yield n==null?void 0:n.handler(...o),s(M),H(e,({resolve:p})=>p())),r){const{config:p}=t,a=p.transform;p.transform=m;const c=yield t;return p.transform=a,c}}finally{s(M),ys(e,0,B(e))}}),oo=t=>{let e=m,s=m,o=m;if(T(t))e=t;else if(tt(t)){const{onSuccess:n,onError:i,onComplete:r}=t;e=T(n)?n:e,s=T(i)?i:s,o=T(r)?r:o}return{onSuccess:e,onError:s,onComplete:o}},no=({visitorMeta:t,login:e,logout:s,refreshTokenOnSuccess:o,refreshTokenOnError:n,assignToken:i=D})=>{let r=M;const l=[];return{waitingList:l,onAuthRequired:a=>c=>F(void 0,null,function*(){const d=Y(c,t||Vt),u=Y(c,(e==null?void 0:e.metaMatches)||bt);return!d&&!u&&!Y(c,(o==null?void 0:o.metaMatches)||Ut)&&!Y(c,(n==null?void 0:n.metaMatches)||Ut)&&r&&(yield Oe(c,l)),!d&&!u&&(yield i(c)),a==null?void 0:a(c)}),onResponseRefreshToken:a=>{const c=oo(a);return O(S({},c),{onSuccess:(d,u)=>F(void 0,null,function*(){if(!Y(u,t||Vt)&&!Y(u,(e==null?void 0:e.metaMatches)||bt)&&!Y(u,(o==null?void 0:o.metaMatches)||Ut)){const w=yield Ee(u,l,C=>{r=C},[d,u],o,r);if(w)return w}return yield _e(u,e,bt,d),yield _e(u,s,so,d),(c.onSuccess||Ft)(d,u)}),onError:(d,u)=>F(void 0,null,function*(){if(!Y(u,t||Vt)&&!Y(u,(e==null?void 0:e.metaMatches)||bt)&&!Y(u,(n==null?void 0:n.metaMatches)||Ut)){const w=yield Ee(u,l,C=>{r=C},[d,u],n,r);if(w)return w}return(c.onError||D)(d,u)})})}}},ao=(t,e)=>{let s=Te;return function(...n){const i=t.bind(this,...n),r=re(e)?e:e(...n);s&&Cs(s),r>0?s=Nt(i,r):i()}},ro=(t,e)=>{const s={};for(const o in t)s[o]=e(t[o],o,t);return s};var it;(function(t){t[t.USE_REQUEST=1]="USE_REQUEST",t[t.USE_WATCHER=2]="USE_WATCHER",t[t.USE_FETCHER=3]="USE_FETCHER"})(it||(it={}));function co(t,e=S({trackedKeys:{},bindError:M,initialRequest:M},Ds())){const s=a=>t.ref?t.ref(a):{current:a};e=s(e).current;const o=a=>(t.export||Ft)(a,e),n=a=>{if(!T(t.memorize))return a;const c=t.memorize(a);return c.memorized=U,c},{dehydrate:i}=t,r=(a,c,d)=>a!==i(c,d,e)&&e.trackedKeys[d]&&t.update(a,c,d,e),l=a=>Z(a,c=>z(c,xt)?c.e:c),f=[],p={};return{create:(a,c)=>(V(f,c),_(Ce,t.create(a,c,e),c,d=>i(d,c,e),o,(d,u)=>r(u,d,c))),computed:(a,c,d)=>(H(c,u=>{u.k&&(p[u.k]=U)}),_(xt,t.computed(a,l(c),d,e),d,u=>i(u,d,e),o)),effectRequest:a=>t.effectRequest(a,e),ref:s,watch:(a,c)=>t.watch(l(a),c,e),onMounted:a=>t.onMounted(a,e),onUnmounted:a=>t.onUnmounted(a,e),memorize:n,__referingObj:e,exposeProvider:a=>{const c={},d={},u=[];for(const g in a){const v=a[g];if(T(v)&&!e.trackedKeys[g])c[g]=g.startsWith("on")?(...E)=>(v(...E),b):v.memorized?v:n(v);else{!Wt(["uploading","downloading"],g)&&!g.startsWith("__")&&V(u,g);const E=z(v,xt);E&&(d[g]=v.s),wt.defineProperty(c,g,{get:()=>(e.trackedKeys[g]=U,E?v.e:v),set:D,enumerable:U,configurable:U})}}const{update:w,__proxyState:C}=c;e.trackedKeys=S({},p),e.bindError=M;const{then:y}=c,$={__referingObj:e,update:n(g=>{ct(g).forEach(v=>{Wt(f,v)?r(g[v],d[v],v):v in c&&T(w)&&w({[v]:g[v]})})}),__proxyState:n(g=>Wt(f,g)&&z(a[g],xt)?(e.trackedKeys[g]=U,a[g]):C(g)),then(g,v){H(u,E=>{e.trackedKeys[E]=U});const N=()=>{ft(b,"then"),g(b)};T(y)?y(N,v):N()}},b=ie(c,$);return b},objectify:(a,c)=>a.reduce((d,u)=>(d[u.k]=c?u[c]:u,d),{}),transformState2Proxy:(a,c)=>_(Ce,a,c,d=>i(d,c,e),o,(d,u)=>r(u,d,c))}}const io=qt("useRequest"),lo=qt("useWatcher"),uo=qt("useFetcher"),We=t=>({[it.USE_REQUEST]:io,[it.USE_WATCHER]:lo,[it.USE_FETCHER]:uo})[t],fo=(t,e)=>t(z(e,W),"expected a method instance."),kt="success",It="error",te="complete";var po=(t,e,s,o)=>({m,rf:{},fs:{},em:s,ht:t,c:e,ro:o,ms:{}});class ht{constructor(e,s){this.method=e,this.args=s}clone(){return S({},this)}static spawn(e,s){return _(ht,e,s)}}class ho extends ht{constructor(e,s,o){super(e.method,e.args),this.data=s,this.fromCache=o}}class mo extends ht{constructor(e,s){super(e.method,e.args),this.error=s}}class Me extends ht{constructor(e,s,o,n,i){super(e.method,e.args),this.status=s,this.data=o,this.fromCache=s==="error"?!1:n,this.error=i}}const go=(t,e)=>e(),Pt={},vo=(t,e)=>{const s=Pt[t]||{};return s[e]?Array.from(s[e]):[]},So=(t,e,s)=>{const o=Pt[t]=Pt[t]||{};o[e]||(o[e]=_(Set)),o[e].add(s)},Co=(t,e,s)=>{const o=Pt[t],n=o[e];o&&n&&(s?n.delete(s):n.clear(),n.size===0&&ft(o,e))};function ee(t,e,s=[]){const o=We(t.ht);let n=De(e,o,s);const{fs:i,ht:r,c:l}=t,{loading:f,data:p,error:a}=i,c=r===it.USE_FETCHER,{force:d=M,middleware:u=go}=l,w=mt(n),{id:C}=w,y=yt(n),{abortLast:$=U}=l,b=!t.m;return t.m=n,F(this,null,function*(){let g=D,v=M,N=ms(m),E=D,et=D;const st=yield Hs(n);let Q=()=>!!st,K=M;c||(So(C,y,t),g=()=>Co(C,y,t));const L=h=>{v=U;const{force:R=d,method:x=n}=h||{},P=$e(R,[_(ht,n,s)]),j=at=>({loaded:Ve,total:Ge})=>{i[at].v={loaded:Ve,total:Ge}};n=x,t.rf[y]=g,K||(f.v=!!P||!st);const{downloading:A,uploading:J}=t.ro.trackedKeys;return E=A?n.onDownload(j("downloading")):E,et=J?n.onUpload(j("uploading")):et,N=n.send(P),Q=()=>n.fromCache||M,N},lt={method:n,cachedResponse:st,config:l,abort:()=>n.abort()},G=()=>r!==it.USE_WATCHER||!$||t.m===n,dt=(h=U)=>{h&&b&&(f.v=M),K=h},ot=u(c?O(S({},lt),{args:s,fetch:(h,...R)=>(fo(o,h),ee(t,h,R)),proxyStates:Ms(i,"data"),controlLoading:dt}):O(S({},lt),{args:s,send:(...h)=>ee(t,e,h),proxyStates:i,controlLoading:dt}),L);let nt=m;const X=ht.spawn(n,s);try{const h=yield ot,R=x=>(c?t.c.updateState!==M&&H(vo(C,y),P=>{P.fs.data.v=x}):G()&&(p.v=x),G()&&(a.v=m,!K&&(f.v=M),t.em.emit(kt,_(ho,X,x,Q())),t.em.emit(te,_(Me,X,kt,x,Q(),m))),x);nt=h!==m?R(h):v?yield I(N,R,()=>R(m)):m,!v&&!K&&(f.v=M)}catch(h){throw G()&&(a.v=h,!K&&(f.v=M),t.em.emit(It,_(mo,X,h)),t.em.emit(te,_(Me,X,It,m,Q(),h))),h}return E(),et(),nt})}const vt=t=>t.current;function wo(t,e,s,o,n=M,i,r=0){var l;s=S({},s);let f=!!n,p=m;if(n)try{const h=De(e,We(t)),R=mt(h),x=R.l1Cache.get(Dt(R.id,yt(h)));if(x&&!z(x,q)){const[j,A]=x;(!A||A>Ct())&&(p=j)}f=!!$e((l=s.force)!==null&&l!==void 0?l:M)||!p}catch(h){}const{create:a,effectRequest:c,ref:d,objectify:u,exposeProvider:w,transformState2Proxy:C,__referingObj:y}=co(eo(),s.__referingObj),$={total:0,loaded:0},{managedStates:b={}}=s,g=ro(b,(h,R)=>C(h,R)),v=a(p!=null?p:T(o)?o():o,"data"),N=a(f,"loading"),E=a(m,"error"),et=a(S({},$),"downloading"),st=a(S({},$),"uploading"),Q=u([v,N,E,et,st]),K=le(),L=vt(d(po(t,s,K,y)));L.fs=Q,L.em=K,L.c=s,L.ms=S(S({},Q),g);const lt=(h=e,R)=>ee(L,h,R),G=d(m),dt=d(M),ot=vt(d(Ts())),nt=(h=y,R)=>{ot(()=>{(!de.ssr||vt(G))&&(y.initialRequest=dt.current=U,I(lt(R),()=>{var x;(x=vt(G))===null||x===void 0||x.resolve()},x=>{var P;if(!h.bindError&&!h.trackedKeys.error&&!vt(G))throw x;(P=vt(G))===null||P===void 0||P.reject(x)}))})};d(ao((h,R,x)=>nt(R,x),h=>re(h)?ne(r)?r[h]:r:0)),c({handler:()=>nt(y),removeStates:()=>{H(ws(L.rf),h=>h())},frontStates:S(S({},Q),g),watchingStates:i,immediate:n!=null?n:U});const X=w(O(S({},u([v,N,E,et,st])),{abort:()=>L.m&&L.m.abort(),send:(h,R)=>lt(R,h),onSuccess(h){K.on(kt,h)},onError(h){y.bindError=U,K.on(It,h)},onComplete(h){K.on(te,h)},then(h,R){const{promise:x,resolve:P,reject:j}=bs();G.current={resolve:P,reject:j},Nt(()=>{!dt.current&&P()},10),I(x,()=>{h(X)},R)}}));return X}function yo(t,e={}){const{immediate:s=U,initialData:o}=e,n=wo(it.USE_REQUEST,t,e,o,!!s),{send:i}=n;return ie(n,{send:(...r)=>i(r)})}var be;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.OPEN=1]="OPEN",t[t.CLOSED=2]="CLOSED"})(be||(be={}));var Ue;(function(t){t.Open="open",t.Error="error",t.Message="message"})(Ue||(Ue={}));var se={name:"Vue",create:t=>Ie(t),dehydrate:t=>t.value,update:(t,e)=>{e.value=t},effectRequest({handler:t,removeStates:e,immediate:s,watchingStates:o}){Lt()&&he(e),s&&t(),H(o||[],(n,i)=>{me(n,()=>{t(i)},{deep:U})})},computed:t=>ke(t),watch:(t,e)=>{me(t,e,{deep:U})},onMounted:t=>{Lt()?ts(t):Nt(t,10)},onUnmounted:t=>{Lt()&&he(t)}},Ro={get(t){return ns(t)},set(t,e){os(t,e)},remove(t){ss(t)},clear(){es()}};const xo=(t,e)=>{const{url:s,data:o,type:n,headers:i}=t;let r,l=D,f=D;const p=new Promise((a,c)=>{const{config:d}=e,{requestType:u,timeout:w}=d;if(u==="upload"){const C={},y={};tt(o)&&Object.keys(o).forEach(b=>{["name","files","file","filePath"].includes(b)?y[b]=o[b]:C[b]=o[b]});const $=r=as(O(S(S({},d),y),{name:y.name,url:s,header:i,formData:C,timeout:w,success:b=>a(b),fail:b=>c(new Error(b.errMsg)),complete:D}));f=b=>{$.onProgressUpdate(({totalBytesSent:g,totalBytesExpectedToSend:v})=>{b(g,v)})}}else if(u==="download"){const C=r=rs(O(S({},d),{url:s,header:i,timeout:w,success:y=>a(y),fail:y=>c(new Error(y.errMsg)),complete:D}));l=y=>{C.onProgressUpdate(({totalBytesWritten:$,totalBytesExpectedToWrite:b})=>{y($,b)})}}else r=cs(O(S({},d),{url:s,data:o,header:i,method:n,timeout:w,success:C=>a(C),fail:C=>c(new Error(C.errMsg))}))});return{response:()=>p,headers:()=>p.then(a=>a.header||{}),abort:()=>{r.abort()},onDownload:l,onUpload:f}};var _o=O(S({},se),{effectRequest(t,e){const{handler:s}=t;return t.handler=(...o)=>{B(o)>0?s(...o):Promise.resolve().then(()=>s(...o))},se.effectRequest(t,e)}});function Eo({mockRequest:t}={}){return{statesHook:_o,requestAdapter:t||xo,l2Cache:Ro}}var ue=(t=>(t[t.Success=0]="Success",t[t.Error=400]="Error",t[t.Unauthorized=401]="Unauthorized",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.RequestTimeout=408]="RequestTimeout",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.HttpVersionNotSupported=505]="HttpVersionNotSupported",t))(ue||{}),Be=(t=>(t.JSON="application/json;charset=UTF-8",t.FORM_URLENCODED="application/x-www-form-urlencoded;charset=UTF-8",t.FORM_DATA="multipart/form-data;charset=UTF-8",t))(Be||{});function Mo(t){let e;switch(t){case 400:e="请求错误(400)";break;case 401:e="未授权，请重新登录(401)";break;case 403:e="拒绝访问(403)";break;case 404:e="请求出错(404)";break;case 408:e="请求超时(408)";break;case 500:e="服务器错误(500)";break;case 501:e="服务未实现(501)";break;case 502:e="网络错误(502)";break;case 503:e="服务不可用(503)";break;case 504:e="网络超时(504)";break;case 505:e="HTTP版本不受支持(505)";break;default:e=`连接出错(${t})!`}return`${e}，请检查网络或联系管理员！`}var bo={};const Uo={SECONDARY:"https://ukw0y1.laf.run"},{onAuthRequired:To,onResponseRefreshToken:Fo}=no({refreshTokenOnError:{isExpired:t=>{var e;return((e=t.response)==null?void 0:e.status)===ue.Unauthorized},handler:()=>F(void 0,null,function*(){})}}),Ao=to(O(S({baseURL:bo.VITE_API_BASE_URL},Eo()),{timeout:5e3,statesHook:se,beforeRequest:To(t=>{var s,o;t.config.headers=S({ContentType:Be.JSON,Accept:"application/json, text/plain, */*"},t.config.headers);const{config:e}=t;(s=e.meta)!=null&&s.ignoreAuth,(o=e.meta)!=null&&o.domain&&(t.baseURL=e.meta.domain)}),responded:Fo((t,e)=>{var a;const{config:s}=e,{requestType:o}=s,{statusCode:n,data:i,errMsg:r}=t;if(o==="upload"||o==="download")return t;if(n!==200){const c=Mo(n)||`HTTP请求错误[${n}]`;throw ge.error(c),new Error(`${c}：${r}`)}const{code:l,message:f,data:p}=i;if(l!==ue.Success)throw((a=s.meta)==null?void 0:a.toast)!==!1&&ge.warning(f),new Error(`请求错误[${l}]：${f}`);return p})})),Po=Ao;function No(){return Po.Get("/foo",{params:{name:"菲鸽",page:1,pageSize:10},meta:{domain:Uo.SECONDARY}})}const Do=is({__name:"alova",setup(t){const{loading:s,data:o,send:n}=yo(No,{initialData:void 0,immediate:!0});function i(){o.value=void 0}return(r,l)=>{const f=us,p=ds,a=ls("layout-default-uni");return Ht(),ve(a,null,{default:k(()=>[ut(p,{class:"p-6 text-center"},{default:k(()=>[ut(f,{class:"my-6 w-200px text-green",onClick:Rt(n)},{default:k(()=>[gt(" 发送请求 ")]),_:1},8,["onClick"]),ut(p,{class:"h-16"},{default:k(()=>[Rt(s)?(Ht(),ve(p,{key:0},{default:k(()=>[gt(" loading... ")]),_:1})):(Ht(),fs(ps,{key:1},[ut(p,{class:"text-xl"},{default:k(()=>[gt(" 请求数据如下 ")]),_:1}),ut(p,{class:"text-green leading-8"},{default:k(()=>[gt(Se(JSON.stringify(Rt(o))),1)]),_:1})],64)),ut(p,{class:"text-red"},{default:k(()=>{var c;return[gt(Se((c=Rt(o))==null?void 0:c.id),1)]}),_:1})]),_:1}),ut(f,{class:"my-6 w-200px text-red",disabled:!Rt(o),onClick:i},{default:k(()=>[gt(" 重置数据 ")]),_:1},8,["disabled"])]),_:1})]),_:1})}}}),Lo=hs(Do,[["__scopeId","data-v-5cb08705"]]);export{Lo as default};
